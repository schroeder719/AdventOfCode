import queue
def prettyprint(code, p, n=10):
    if n is 0:
        start = 0
        end = len(code)
    else:
        start = max(p-n, 0)
        end = min(len(code), p+n)
    
    print("[",end="")
    for i in range (start,end):
        if i == p: print("({})".format(i), end="\t")
        else: print("{}".format(i), end="\t")
        
    print("]")
    print("[",end="")
    for i in range (start,end):
        print("{},".format(code[i]), end="\t")
    print("]")

class Intcode():
    code = []
    input_que = None
    output_que = None
    debug = False
    relative_base = 0
    program_counter = 0

    NO_ERROR = 0
    COMPLETE = 5
    INPUT_NEEDED = 10
    OUTPUT_AVAILABLE = 20

    def __init__(self, code):
        self.code = code + 5000 * [0,]
        self.relative_base = 0
        self.program_counter = 0
        self.input_que = queue.Queue()
        self.output_que = queue.Queue()
        self.debug=True

    def input(self, val):
        self.input_que.put_nowait(val)

    def output(self):
        return self.output_que.get()

    def run(self):
        blocked = False 
        while not blocked:
            rc = self.cycle()
            if rc in [self.INPUT_NEEDED, self.OUTPUT_AVAILABLE, self.COMPLETE]:
                blocked = True
        return rc

    def cycle(self):
        code = self.code
        debug = self.debug
        p = self.program_counter
        return_code = self.NO_ERROR
        if debug: print("p: {} RB:{}".format(p,self.relative_base))
        code_str = str(code[p]).zfill(5)
        if debug: print(code_str)
        op = int(code_str[3])*10 + int(code_str[4])
        m1 = int(code_str[2])
        m2 = int(code_str[1])
        m3 = int(code_str[0])

        if m1 == 0:   o1 = code[p+1]                    # Position Mode
        elif m1 == 2: o1 = self.relative_base + code[p+1]    # Relative Mode
        else:         o1 = p+1                          # Imediate Mode
            
        if m2 == 0:   o2 = code[p+2]
        elif m2 == 2: o2 = self.relative_base + code[p+2]
        else:         o2 = p+2

        if m3 == 0:   o3 = code[p+3]
        elif m3 == 2: o3 = self.relative_base + code[p+3]
        else:         o3 = p+3

        if debug: 
            print("Op: {} m1: {} m2: {} m3: {}".format(op,m1,m2,m3))
            prettyprint(code, p)
        #for i in code:
        #    if type(i) != type(int(1)):
        #        print("Type error in intcode!!!")
        if op == 1: #add
            if debug: print("+++ Add +++")
            d = o3
            if debug: print("o1={} o2={} d={}  cod[d]={}".format(o1,o2,d,code[d]))
            code[d] = int(code[o1]) + int(code[o2])
            p+=4

        elif op == 2: #multiply
            if debug: print("+++  multiply  +++")
            d = o3
            if debug: print("o1={} o2={} d={}  cod[d]={}".format(o1,o2,d,code[d]))            
            code[d] = code[o1] * code[o2]
            p+=4

        elif op == 3: #input
            if debug: print("+++  Input  +++")
            if self.input_que.empty():
                return_code = self.INPUT_NEEDED
            else:
                val = self.input_que.get()
                #val = input("$: ")
                d = o1
                if debug: print("o1={} code[o1]={} d={}  code[d]={}".format(o1,code[o1],d,code[d]))
                code[d] = int(val)
                p+=2
        elif op == 4: #output
            if debug: print("+++  Output  +++")
            self.output_que.put_nowait(code[o1])
            return_code = self.OUTPUT_AVAILABLE
            #print("output: {}".format(code[o1]))
            p+=2
        elif op == 5: #jump-if-true
            if debug: print("+++  jump-if-true  +++")
            if debug: print("{} {} {} {}".format(o1,o2,code[o1], code[o2]))              
            if code[o1] is not  0:
                p = code[o2]
            else:
                p+=3
        elif op == 6: #jump-if-false
            if debug: print("+++  jump-if-false  +++")
            if debug: print("{} {} {} {}".format(o1,o2,code[o1], code[o2]))    
            
            if code[o1] is 0:
                p = code[o2]
            else:
                p+=3
        elif op == 7: #less than
            if debug: print("+++  less than   +++")           
            d = o3
            if debug: print("o1={} o2={} d={}  cod[d]={}".format(o1,o2,d,code[d]))

            if code[o1] < code[o2]:
                code[d] = 1
            else:
                code[d] = 0
            
            p+=4
            
        elif op == 8: #equals
            if debug: print("+++  equals  +++")
            d = o3
            if debug: print("o1={} o2={} d={}  cod[d]={}".format(o1,o2,d,code[d]))
        
            if code[o1] == code[o2]:
                code[d] = 1
            else:
                code[d] = 0
            p+=4
        elif op == 9: #adjust relative base
            if debug: print("+++  adjust relative base  ++++")
            if debug: print("{} {}".format(o1,code[o1]))           
            self.relative_base+=  code[o1]
            if debug: print("rb: {}->{}".format(self.relative_base-code[o1],self.relative_base))
            p+=2
        elif code[p] == 99:
            return_code = self.COMPLETE
        else:
            print("error")
            return -1
        if debug: print(" ")
        
        self.program_counter = p
        return return_code

class Pos:
    x = 0
    y = 0
    
    DIR_NORTH = 1
    DIR_SOUTH = 2
    DIR_WEST  = 3
    DIR_EAST  = 4
    
    def __init__(self,x, y):
        self.x = x
        self.y = y
    def north(self):
        self.y-=1
    def south(self):
        self.y+=1
    def east(self):
        self.x+=1
    def west(self):
        self.x-=1
    def move(self,direction):
        if direction == self.DIR_NORTH:
            self.north()
        elif direction == self.DIR_SOUTH:
            self.south()
        elif direction == self.DIR_EAST:
            self.east()
        elif direction == self.DIR_WEST:
            self.west()

class Board:
    width = 0
    height = 0
    buffer = []
    current_pos = None
    under_robot = 0
    TILE_NONE = 0
    TILE_FLOOR = 1
    TILE_WALL = 2
    TILE_ROBOT = 3
    TILE_OXYGEN = 4
    TILE_UNKNOWN = 5

    RESULT_WALL = 0
    RESULT_MOVE = 1
    RESULT_OXY  = 2

    DIR_NORTH = 1
    DIR_SOUTH = 2
    DIR_WEST  = 3
    DIR_EAST  = 4
    

    tile_map = {TILE_NONE:' ', TILE_FLOOR:'.', TILE_WALL:'#',TILE_ROBOT:'D', TILE_OXYGEN:'O', TILE_UNKNOWN:'?'}

    def __init__(self,width,height):
        self.width = width
        self.height = height
        self.under_robot = self.TILE_FLOOR
        #print("{},{}".format(self.width,self.height))
        self.buffer = [[self.TILE_UNKNOWN for i in range(self.width)] for j in range(self.height)]
        self.current_pos = Pos(int(self.width/2),int(self.height/2))
        

    def draw_to_screen(self, screen, draw_format):
        #print("{},{}".format(len(self.buffer[0]),len(self.buffer)))
        for y in range(len(self.buffer)):
            for x in range(len(self.buffer[y])):
                #print("{},{}".format(x,y))
                c = self.buffer[y][x]
                text_window.addstr(y,x,self.tile_map[c])
        text_window.addnstr(int(self.current_pos.y),self.current_pos.x,self.tile_map[self.TILE_ROBOT], draw_format)
    
    def move(self, direction, result):
        
        if result == self.RESULT_WALL:
            if direction == self.DIR_NORTH:
                self.buffer[self.current_pos.y-1][self.current_pos.x] = self.TILE_WALL
            elif direction == self.DIR_SOUTH:
                self.buffer[self.current_pos.y+1][self.current_pos.x] = self.TILE_WALL
            elif direction == self.DIR_EAST:
                self.buffer[self.current_pos.y][self.current_pos.x+1] = self.TILE_WALL
            elif direction == self.DIR_WEST:
                self.buffer[self.current_pos.y][self.current_pos.x-1] = self.TILE_WALL
            
        elif result == self.RESULT_MOVE:
            self.buffer[self.current_pos.y][self.current_pos.x] = self.under_robot
            self.current_pos.move(direction)
            self.buffer[self.current_pos.y][self.current_pos.x] = self.TILE_ROBOT
            self.under_robot = self.TILE_FLOOR
        elif result == self.RESULT_OXY:
            self.buffer[self.current_pos.y][self.current_pos.x] = self.under_robot
            if direction == self.DIR_NORTH:
                self.buffer[self.current_pos.y-1][self.current_pos.x] = self.TILE_ROBOT
            elif direction == self.DIR_SOUTH:
                self.buffer[self.current_pos.y+1][self.current_pos.x] = self.TILE_ROBOT
            elif direction == self.DIR_EAST:
                self.buffer[self.current_pos.y][self.current_pos.x+1] = self.TILE_ROBOT
            elif direction == self.DIR_WEST:
                self.buffer[self.current_pos.y+1][self.current_pos.x-1] = self.TILE_ROBOT
            self.under_robot = self.TILE_OXYGEN

# class AutoBot:
#     path = []
#     RESULT_WALL = 0
#     RESULT_MOVE = 1
#     RESULT_OXY  = 2
    
#     DIR_NORTH = 1
#     DIR_SOUTH = 2
#     DIR_WEST  = 3
#     DIR_EAST  = 4
    
#     next_command = 0
#     last_command = 0


#     def __init__(self, breadthFirst):        
#         next_command = DIR_WEST

#     def getCommand():
#         return next_command

#     def putResult(result):
#         if result == RESULT_WALL:
#             if last_command == DIR_WEST:
#                 next_command = DIR_NORTH
#             elif last_command == DIR_NORTH:
#                 next_command = DIR_EAST
#             elif last_command == DIR_EAST:
#                 next_command = DIR_SOUTH
#             elif last_command == DIR_SOUTH:
#                 val = self.path.pop()
                

#         elif result == RESULT_MOVE:
#             pass

codebank = [
    [],
    [109,1,204,-1,1001,100,1,100,1008,100,16,101,1006,101,0,99],
    [1102,34915192,34915192,7,4,7,99,0],
    [104,1125899906842624,99],
    [1102,34463338,34463338,63,1007,63,34463338,63,1005,63,53,1102,3,1,1000,109,988,209,12,9,1000,209,6,209,3,203,0,1008,1000,1,63,1005,63,65,1008,1000,2,63,1005,63,904,1008,1000,0,63,1005,63,58,4,25,104,0,99,4,0,104,0,99,4,17,104,0,99,0,0,1102,1,0,1020,1101,0,23,1010,1102,1,31,1009,1101,34,0,1019,1102,38,1,1004,1101,29,0,1017,1102,1,25,1018,1102,20,1,1005,1102,1,24,1008,1101,897,0,1024,1101,0,28,1016,1101,1,0,1021,1101,0,879,1028,1102,1,35,1012,1101,0,36,1015,1101,311,0,1026,1102,1,37,1011,1101,26,0,1014,1101,21,0,1006,1102,1,32,1002,1102,1,33,1003,1102,27,1,1001,1102,1,667,1022,1101,0,892,1025,1101,664,0,1023,1101,30,0,1000,1101,304,0,1027,1101,22,0,1013,1102,1,874,1029,1102,1,39,1007,109,12,21108,40,41,1,1005,1013,201,1001,64,1,64,1106,0,203,4,187,1002,64,2,64,109,5,1205,4,221,4,209,1001,64,1,64,1106,0,221,1002,64,2,64,109,5,21108,41,41,-5,1005,1017,243,4,227,1001,64,1,64,1106,0,243,1002,64,2,64,109,-30,2101,0,8,63,1008,63,30,63,1005,63,269,4,249,1001,64,1,64,1105,1,269,1002,64,2,64,109,15,2101,0,-5,63,1008,63,35,63,1005,63,293,1001,64,1,64,1106,0,295,4,275,1002,64,2,64,109,28,2106,0,-8,1001,64,1,64,1105,1,313,4,301,1002,64,2,64,109,-22,1205,7,329,1001,64,1,64,1106,0,331,4,319,1002,64,2,64,109,-12,1208,6,37,63,1005,63,351,1001,64,1,64,1106,0,353,4,337,1002,64,2,64,109,-3,2108,21,8,63,1005,63,375,4,359,1001,64,1,64,1106,0,375,1002,64,2,64,109,14,1201,-5,0,63,1008,63,39,63,1005,63,401,4,381,1001,64,1,64,1105,1,401,1002,64,2,64,109,17,1206,-9,419,4,407,1001,64,1,64,1105,1,419,1002,64,2,64,109,-10,21101,42,0,-4,1008,1015,42,63,1005,63,445,4,425,1001,64,1,64,1105,1,445,1002,64,2,64,109,-5,1206,7,457,1105,1,463,4,451,1001,64,1,64,1002,64,2,64,109,-6,2107,34,-5,63,1005,63,479,1105,1,485,4,469,1001,64,1,64,1002,64,2,64,109,-8,2102,1,5,63,1008,63,23,63,1005,63,505,1106,0,511,4,491,1001,64,1,64,1002,64,2,64,109,5,2102,1,1,63,1008,63,21,63,1005,63,537,4,517,1001,64,1,64,1105,1,537,1002,64,2,64,109,15,21107,43,44,-6,1005,1014,555,4,543,1106,0,559,1001,64,1,64,1002,64,2,64,109,-6,1207,-7,38,63,1005,63,579,1001,64,1,64,1106,0,581,4,565,1002,64,2,64,109,-17,1201,4,0,63,1008,63,28,63,1005,63,601,1106,0,607,4,587,1001,64,1,64,1002,64,2,64,109,14,2107,31,-9,63,1005,63,625,4,613,1105,1,629,1001,64,1,64,1002,64,2,64,109,15,21102,44,1,-7,1008,1019,44,63,1005,63,651,4,635,1106,0,655,1001,64,1,64,1002,64,2,64,109,3,2105,1,-6,1106,0,673,4,661,1001,64,1,64,1002,64,2,64,109,-14,21101,45,0,2,1008,1017,42,63,1005,63,693,1105,1,699,4,679,1001,64,1,64,1002,64,2,64,109,5,21107,46,45,-8,1005,1012,719,1001,64,1,64,1105,1,721,4,705,1002,64,2,64,109,-19,2108,21,7,63,1005,63,737,1106,0,743,4,727,1001,64,1,64,1002,64,2,64,109,9,1207,-2,25,63,1005,63,761,4,749,1106,0,765,1001,64,1,64,1002,64,2,64,109,-10,1208,1,27,63,1005,63,783,4,771,1106,0,787,1001,64,1,64,1002,64,2,64,109,5,1202,4,1,63,1008,63,29,63,1005,63,807,1106,0,813,4,793,1001,64,1,64,1002,64,2,64,109,8,21102,47,1,0,1008,1013,50,63,1005,63,833,1106,0,839,4,819,1001,64,1,64,1002,64,2,64,109,-12,1202,8,1,63,1008,63,31,63,1005,63,865,4,845,1001,64,1,64,1105,1,865,1002,64,2,64,109,34,2106,0,-7,4,871,1105,1,883,1001,64,1,64,1002,64,2,64,109,-18,2105,1,7,4,889,1105,1,901,1001,64,1,64,4,64,99,21101,0,27,1,21101,915,0,0,1106,0,922,21201,1,13801,1,204,1,99,109,3,1207,-2,3,63,1005,63,964,21201,-2,-1,1,21102,942,1,0,1106,0,922,21201,1,0,-1,21201,-2,-3,1,21102,957,1,0,1105,1,922,22201,1,-1,-2,1106,0,968,21202,-2,1,-2,109,-3,2106,0,0],
    [3,1033,1008,1033,1,1032,1005,1032,31,1008,1033,2,1032,1005,1032,58,1008,1033,3,1032,1005,1032,81,1008,1033,4,1032,1005,1032,104,99,101,0,1034,1039,1002,1036,1,1041,1001,1035,-1,1040,1008,1038,0,1043,102,-1,1043,1032,1,1037,1032,1042,1105,1,124,1001,1034,0,1039,101,0,1036,1041,1001,1035,1,1040,1008,1038,0,1043,1,1037,1038,1042,1105,1,124,1001,1034,-1,1039,1008,1036,0,1041,102,1,1035,1040,1001,1038,0,1043,101,0,1037,1042,1106,0,124,1001,1034,1,1039,1008,1036,0,1041,101,0,1035,1040,1002,1038,1,1043,101,0,1037,1042,1006,1039,217,1006,1040,217,1008,1039,40,1032,1005,1032,217,1008,1040,40,1032,1005,1032,217,1008,1039,33,1032,1006,1032,165,1008,1040,35,1032,1006,1032,165,1101,0,2,1044,1105,1,224,2,1041,1043,1032,1006,1032,179,1101,0,1,1044,1106,0,224,1,1041,1043,1032,1006,1032,217,1,1042,1043,1032,1001,1032,-1,1032,1002,1032,39,1032,1,1032,1039,1032,101,-1,1032,1032,101,252,1032,211,1007,0,68,1044,1105,1,224,1101,0,0,1044,1106,0,224,1006,1044,247,101,0,1039,1034,102,1,1040,1035,1001,1041,0,1036,102,1,1043,1038,101,0,1042,1037,4,1044,1105,1,0,30,84,39,21,27,93,20,65,45,95,19,6,71,25,33,13,80,53,60,70,65,80,45,65,53,62,93,13,19,72,33,49,54,92,9,29,25,69,7,46,9,96,97,70,8,69,71,97,3,75,94,49,96,11,76,24,29,84,87,99,33,76,83,83,21,62,97,82,63,71,78,74,29,94,90,34,92,58,75,44,66,99,28,37,84,18,18,94,86,50,4,74,3,96,74,39,99,55,93,44,94,55,40,78,2,88,70,6,69,67,87,40,4,93,76,30,1,42,40,87,23,83,89,24,73,19,62,88,43,92,94,50,71,53,19,75,22,9,82,46,65,84,92,63,99,57,23,62,93,61,14,87,67,84,90,38,96,83,33,63,40,80,75,10,79,89,52,14,97,32,87,72,57,79,7,79,6,93,66,77,50,19,97,78,65,96,24,94,80,12,10,70,9,60,77,67,17,83,76,36,79,27,43,91,6,72,77,49,4,47,56,85,81,11,46,96,93,33,82,44,69,49,34,98,77,95,38,19,85,1,62,73,49,95,39,62,36,83,23,93,34,32,21,94,89,30,85,76,13,92,87,3,84,43,3,74,39,81,6,85,16,69,89,21,56,80,65,92,84,97,7,63,23,8,87,37,70,54,75,92,95,96,51,83,34,24,86,39,59,48,89,45,34,89,72,3,77,63,98,38,70,39,38,98,97,85,46,96,53,81,89,27,83,75,31,81,71,39,81,62,79,11,78,18,90,94,1,91,1,79,77,74,64,20,73,55,75,78,2,77,24,92,56,55,25,70,21,38,69,49,81,19,34,92,97,74,61,79,18,77,51,76,62,92,10,85,83,87,39,90,31,98,95,61,32,63,82,59,75,65,53,72,91,17,75,75,54,85,57,32,13,39,70,48,86,59,50,96,32,23,84,61,85,48,59,92,33,15,58,83,95,48,80,70,84,58,69,70,37,99,18,73,79,32,71,22,41,75,26,71,25,55,73,31,5,53,71,95,65,87,50,62,95,80,54,95,73,79,20,94,65,83,33,26,88,3,11,99,76,93,28,97,67,49,90,94,19,85,28,10,96,70,55,84,17,75,33,47,91,44,88,96,1,6,89,40,69,27,58,98,61,25,77,79,43,83,38,13,72,44,99,20,33,69,8,5,47,72,78,24,53,94,78,39,99,87,9,63,82,52,69,64,48,93,46,48,89,22,84,32,69,7,36,99,80,4,27,92,54,14,85,56,19,99,93,99,49,67,82,90,23,10,77,77,37,79,67,78,27,81,79,34,67,81,40,88,76,89,94,64,80,73,79,57,72,22,14,93,3,88,84,88,41,12,29,4,97,57,83,38,93,51,55,20,75,57,78,22,76,22,24,85,91,79,27,19,46,90,18,71,3,39,28,26,94,87,83,31,35,73,56,99,83,35,65,92,45,98,93,2,73,88,15,90,62,85,95,20,96,75,52,4,62,81,78,49,67,69,20,5,85,72,79,45,34,73,89,20,37,60,79,97,6,41,78,40,70,42,29,89,21,76,88,44,82,17,9,73,52,71,73,25,89,71,30,82,85,26,86,61,43,7,71,13,99,72,40,95,79,39,67,39,65,90,91,14,96,20,73,98,66,13,92,70,1,93,2,86,45,54,85,73,30,62,14,97,89,39,77,99,40,89,76,49,97,42,60,97,62,82,35,98,49,80,15,91,34,87,65,77,44,93,65,87,76,82,20,78,46,90,18,81,73,98,47,99,48,69,2,82,90,90,47,85,49,94,37,81,76,90,0,0,21,21,1,10,1,0,0,0,0,0,0],
    [2,330,331,332,109,3300,1102,1182,1,15,1101,1455,0,24,1002,0,1,570,1006,570,36,101,0,571,0,1001,570,-1,570,1001,24,1,24,1106,0,18,1008,571,0,571,1001,15,1,15,1008,15,1455,570,1006,570,14,21102,58,1,0,1106,0,786,1006,332,62,99,21101,333,0,1,21102,1,73,0,1105,1,579,1101,0,0,572,1101,0,0,573,3,574,101,1,573,573,1007,574,65,570,1005,570,151,107,67,574,570,1005,570,151,1001,574,-64,574,1002,574,-1,574,1001,572,1,572,1007,572,11,570,1006,570,165,101,1182,572,127,102,1,574,0,3,574,101,1,573,573,1008,574,10,570,1005,570,189,1008,574,44,570,1006,570,158,1106,0,81,21101,0,340,1,1105,1,177,21101,477,0,1,1105,1,177,21102,1,514,1,21101,176,0,0,1106,0,579,99,21101,0,184,0,1105,1,579,4,574,104,10,99,1007,573,22,570,1006,570,165,101,0,572,1182,21101,0,375,1,21102,211,1,0,1106,0,579,21101,1182,11,1,21102,222,1,0,1106,0,979,21102,1,388,1,21102,1,233,0,1106,0,579,21101,1182,22,1,21102,1,244,0,1106,0,979,21101,0,401,1,21102,255,1,0,1106,0,579,21101,1182,33,1,21101,0,266,0,1106,0,979,21102,1,414,1,21101,277,0,0,1106,0,579,3,575,1008,575,89,570,1008,575,121,575,1,575,570,575,3,574,1008,574,10,570,1006,570,291,104,10,21101,1182,0,1,21101,313,0,0,1105,1,622,1005,575,327,1101,0,1,575,21102,327,1,0,1106,0,786,4,438,99,0,1,1,6,77,97,105,110,58,10,33,10,69,120,112,101,99,116,101,100,32,102,117,110,99,116,105,111,110,32,110,97,109,101,32,98,117,116,32,103,111,116,58,32,0,12,70,117,110,99,116,105,111,110,32,65,58,10,12,70,117,110,99,116,105,111,110,32,66,58,10,12,70,117,110,99,116,105,111,110,32,67,58,10,23,67,111,110,116,105,110,117,111,117,115,32,118,105,100,101,111,32,102,101,101,100,63,10,0,37,10,69,120,112,101,99,116,101,100,32,82,44,32,76,44,32,111,114,32,100,105,115,116,97,110,99,101,32,98,117,116,32,103,111,116,58,32,36,10,69,120,112,101,99,116,101,100,32,99,111,109,109,97,32,111,114,32,110,101,119,108,105,110,101,32,98,117,116,32,103,111,116,58,32,43,10,68,101,102,105,110,105,116,105,111,110,115,32,109,97,121,32,98,101,32,97,116,32,109,111,115,116,32,50,48,32,99,104,97,114,97,99,116,101,114,115,33,10,94,62,118,60,0,1,0,-1,-1,0,1,0,0,0,0,0,0,1,44,2,0,109,4,2101,0,-3,587,20101,0,0,-1,22101,1,-3,-3,21102,1,0,-2,2208,-2,-1,570,1005,570,617,2201,-3,-2,609,4,0,21201,-2,1,-2,1105,1,597,109,-4,2105,1,0,109,5,2101,0,-4,630,20102,1,0,-2,22101,1,-4,-4,21101,0,0,-3,2208,-3,-2,570,1005,570,781,2201,-4,-3,652,21002,0,1,-1,1208,-1,-4,570,1005,570,709,1208,-1,-5,570,1005,570,734,1207,-1,0,570,1005,570,759,1206,-1,774,1001,578,562,684,1,0,576,576,1001,578,566,692,1,0,577,577,21101,0,702,0,1105,1,786,21201,-1,-1,-1,1105,1,676,1001,578,1,578,1008,578,4,570,1006,570,724,1001,578,-4,578,21102,1,731,0,1105,1,786,1106,0,774,1001,578,-1,578,1008,578,-1,570,1006,570,749,1001,578,4,578,21101,0,756,0,1105,1,786,1105,1,774,21202,-1,-11,1,22101,1182,1,1,21102,1,774,0,1105,1,622,21201,-3,1,-3,1105,1,640,109,-5,2106,0,0,109,7,1005,575,802,20101,0,576,-6,21001,577,0,-5,1105,1,814,21102,0,1,-1,21102,1,0,-5,21101,0,0,-6,20208,-6,576,-2,208,-5,577,570,22002,570,-2,-2,21202,-5,45,-3,22201,-6,-3,-3,22101,1455,-3,-3,1202,-3,1,843,1005,0,863,21202,-2,42,-4,22101,46,-4,-4,1206,-2,924,21101,1,0,-1,1106,0,924,1205,-2,873,21101,35,0,-4,1105,1,924,2101,0,-3,878,1008,0,1,570,1006,570,916,1001,374,1,374,2101,0,-3,895,1102,2,1,0,1202,-3,1,902,1001,438,0,438,2202,-6,-5,570,1,570,374,570,1,570,438,438,1001,578,558,921,21001,0,0,-4,1006,575,959,204,-4,22101,1,-6,-6,1208,-6,45,570,1006,570,814,104,10,22101,1,-5,-5,1208,-5,41,570,1006,570,810,104,10,1206,-1,974,99,1206,-1,974,1102,1,1,575,21102,973,1,0,1105,1,786,99,109,-7,2106,0,0,109,6,21101,0,0,-4,21102,0,1,-3,203,-2,22101,1,-3,-3,21208,-2,82,-1,1205,-1,1030,21208,-2,76,-1,1205,-1,1037,21207,-2,48,-1,1205,-1,1124,22107,57,-2,-1,1205,-1,1124,21201,-2,-48,-2,1106,0,1041,21101,0,-4,-2,1105,1,1041,21102,1,-5,-2,21201,-4,1,-4,21207,-4,11,-1,1206,-1,1138,2201,-5,-4,1059,2102,1,-2,0,203,-2,22101,1,-3,-3,21207,-2,48,-1,1205,-1,1107,22107,57,-2,-1,1205,-1,1107,21201,-2,-48,-2,2201,-5,-4,1090,20102,10,0,-1,22201,-2,-1,-2,2201,-5,-4,1103,2102,1,-2,0,1106,0,1060,21208,-2,10,-1,1205,-1,1162,21208,-2,44,-1,1206,-1,1131,1106,0,989,21102,439,1,1,1105,1,1150,21101,477,0,1,1106,0,1150,21101,514,0,1,21102,1,1149,0,1105,1,579,99,21101,0,1157,0,1105,1,579,204,-2,104,10,99,21207,-3,22,-1,1206,-1,1138,1202,-5,1,1176,1201,-4,0,0,109,-6,2105,1,0,6,9,36,1,7,1,36,1,7,1,23,7,6,1,7,1,23,1,12,1,7,1,23,1,12,1,7,1,23,1,12,5,3,1,11,13,16,1,3,1,11,1,24,11,9,1,24,1,3,1,3,1,1,1,9,1,24,1,3,1,3,1,1,1,9,1,24,1,3,1,3,1,1,1,9,1,24,1,3,1,3,13,24,1,3,1,5,1,34,7,3,1,38,1,1,1,3,1,38,1,1,1,3,1,38,1,1,1,3,1,38,7,40,1,44,1,44,1,44,1,11,7,26,1,11,1,5,1,22,11,5,1,5,1,22,1,3,1,5,1,5,1,5,1,14,13,5,1,5,1,5,1,3,1,10,1,7,1,9,1,5,1,5,1,3,1,10,1,7,1,5,13,3,1,3,1,10,1,7,1,5,1,3,1,5,1,1,1,3,1,3,1,10,1,5,13,5,1,1,1,3,1,3,1,10,1,5,1,1,1,5,1,9,1,1,1,3,1,3,1,10,1,5,1,1,1,5,1,9,11,10,1,5,1,1,1,5,1,11,1,3,1,14,7,1,7,11,1,3,5,36,1,7,1,36,1,7,1,36,1,7,1,36,1,7,1,36,1,7,1,36,9,10],
    [109,4798,21101,3124,0,1,21101,13,0,0,1106,0,1424,21102,166,1,1,21101,0,24,0,1105,1,1234,21101,0,31,0,1105,1,1984,1106,0,13,6,4,3,2,52,51,21,4,28,56,55,3,19,-9,-10,47,89,88,90,90,6,77,73,85,71,1,76,68,63,65,22,-27,70,76,81,87,5,105,105,107,108,95,4,97,92,109,109,5,110,105,110,108,95,4,115,96,109,109,13,-3,59,101,85,92,97,13,84,80,92,78,34,-15,26,-16,46,88,72,79,84,0,72,76,-3,85,74,79,75,-8,64,68,75,57,65,70,64,66,72,8,-41,32,-22,56,77,82,-4,60,76,62,70,-2,74,-11,55,52,68,67,73,56,60,52,-20,44,56,66,-24,48,58,42,49,54,-16,-53,10,0,56,99,96,95,82,94,83,45,-9,23,-13,61,85,88,74,71,82,73,79,73,89,67,65,-4,62,73,70,69,56,68,57,2,-35,24,-14,64,85,90,4,70,67,79,7,83,-2,68,75,-5,78,65,57,75,-10,76,53,76,0,-37,31,-21,57,78,83,-3,64,74,72,0,76,-9,73,58,57,-13,70,57,49,67,-18,54,64,48,55,-23,48,44,56,42,-14,-51,14,-4,74,95,100,14,97,77,86,79,9,92,79,75,5,27,-17,61,82,87,1,68,78,76,4,80,-5,66,58,78,60,-10,73,60,52,70,-15,57,67,51,58,-6,-43,14,-4,74,95,100,14,81,94,90,90,9,92,79,75,5,60,-50,23,42,38,-32,38,39,30,42,47,-38,30,36,28,25,41,38,34,31,18,23,29,19,33,-52,20,29,-55,27,27,27,8,15,-61,22,16,-64,24,13,18,-54,-69,-70,-14,7,12,-74,-8,-11,1,-71,5,-80,-4,-3,3,-15,-84,-85,-109,29,-19,59,80,85,-1,82,62,71,64,-6,77,64,60,-10,62,66,57,59,63,57,67,51,-19,56,58,57,57,-10,-47,44,-34,39,58,54,-16,60,61,57,64,48,56,-23,52,40,60,38,-28,44,53,-31,55,32,55,-35,48,42,41,-39,32,38,42,-42,-44,12,33,38,-48,28,19,25,32,-52,-76,-77,59,-49,13,55,-30,42,51,-33,49,50,32,31,31,39,36,48,-42,24,35,32,34,29,21,35,19,25,37,-53,14,10,26,18,-57,-59,-3,18,23,-63,1,17,3,-67,1,-4,14,-2,6,-73,-8,14,-76,-12,-78,-40,2,4,-13,-82,-106,-107,35,-25,53,74,79,0,74,60,-10,65,53,72,64,52,56,52,50,-19,53,57,62,56,-24,58,54,38,39,40,-29,-31,2,56,35,-34,-58,-59,138,-128,-74,-108,-33,-31,-26,-44,-101,-114,-33,-37,-51,-39,-35,-47,-54,-122,-37,-45,-52,-59,-58,-128,-46,-65,-42,-49,-133,-132,-102,-60,-68,-56,-55,-139,-141,-106,-61,-65,-72,-78,-64,-148,-70,-72,-151,-68,-81,-81,-72,-156,-74,-86,-86,-80,-161,-97,-81,-95,-165,-94,-98,-103,-83,-97,-102,-90,-173,-90,-103,-111,-99,-178,-95,-108,-112,-182,-115,-115,-101,-117,-120,-104,-120,-122,-191,-106,-128,-118,-110,-127,-196,-196,-199,-135,-123,-134,-203,-115,-126,-121,-207,-143,-127,-141,-211,-143,-139,-145,-148,-132,-148,-150,-219,-154,-156,-155,-148,-224,-141,-147,-227,-144,-157,-161,-231,-165,-161,-165,-168,-161,-157,-159,-166,-162,-157,-228,-265,138,-128,-74,-108,-33,-31,-26,-44,-101,-114,-33,-37,-51,-39,-35,-47,-54,-122,-37,-45,-52,-59,-58,-128,-46,-65,-42,-49,-133,-132,-102,-60,-68,-56,-55,-139,-141,-106,-61,-65,-72,-78,-64,-148,-70,-72,-151,-68,-81,-81,-72,-156,-74,-86,-86,-80,-161,-97,-81,-95,-165,-90,-94,-97,-97,-86,-102,-90,-173,-90,-103,-111,-99,-178,-95,-108,-112,-182,-115,-115,-101,-117,-120,-104,-120,-122,-191,-106,-128,-118,-110,-127,-196,-196,-199,-135,-123,-134,-203,-115,-126,-121,-207,-143,-127,-141,-211,-143,-139,-145,-148,-132,-148,-150,-219,-154,-156,-155,-148,-224,-141,-147,-227,-144,-157,-161,-231,-165,-161,-165,-168,-161,-157,-159,-166,-162,-157,-228,-265,263,-253,-199,-233,-158,-156,-151,-169,-226,-239,-158,-162,-176,-164,-160,-172,-179,-247,-162,-170,-177,-184,-183,-253,-171,-190,-167,-174,-258,-257,-227,-183,-197,-187,-175,-182,-193,-184,-268,-202,-191,-194,-192,-197,-205,-191,-207,-276,-278,-222,-201,-196,-282,-206,-219,-196,-286,-207,-206,-210,-223,-222,-223,-225,-280,-293,-296,-232,-220,-231,-300,-212,-223,-218,-304,-236,-228,-223,-239,-227,-310,-227,-240,-244,-314,-248,-237,-250,-243,-239,-247,-237,-308,-345,-273,-260,-248,-243,-263,-329,-252,-252,-248,-260,-267,-266,-253,-337,-249,-260,-255,-259,-342,-260,-267,-280,-270,-271,-348,-281,-268,-272,-279,-285,-342,-355,-280,-278,-279,-284,-277,-361,-282,-278,-274,-275,-290,-298,-300,-369,-300,-292,-290,-373,-309,-375,-299,-298,-301,-310,-302,-297,-370,-383,-302,-316,-321,-311,-315,-299,-321,-308,-392,-306,-322,-330,-312,-397,-326,-334,-317,-401,-330,-338,-324,-325,-337,-329,-339,-341,-398,-411,-347,-335,-346,-415,-334,-352,-350,-346,-341,-338,-422,-334,-345,-340,-344,-427,-345,-357,-357,-351,-432,-365,-361,-353,-367,-370,-354,-363,-351,-427,-464,-441,-397,-373,-434,-447,-376,-380,-374,-375,-373,-452,-454,-398,-377,-372,-458,-376,-388,-382,-377,-387,-396,-465,-400,-398,-468,-404,-404,-395,-403,-473,-390,-396,-476,-406,-409,-395,-480,-408,-404,-483,-418,-396,-486,-403,-399,-409,-417,-413,-421,-493,37,-5,73,71,-8,75,62,58,-12,62,55,74,64,48,50,-19,45,63,-22,61,48,44,-26,50,37,44,48,-31,33,40,48,41,43,30,37,-25,-38,-63,0,0,109,7,21101,0,0,-2,22208,-2,-5,-1,1205,-1,1169,22202,-2,-4,1,22201,1,-6,1,22101,0,-2,2,21101,0,1162,0,2106,0,-3,21201,-2,1,-2,1106,0,1136,109,-7,2105,1,0,109,6,2102,1,-5,1182,20102,1,0,-2,21101,0,0,-3,21201,-5,1,-5,22208,-3,-2,-1,1205,-1,1229,2201,-5,-3,1204,21001,0,0,1,21201,-3,0,2,22101,0,-2,3,21102,1,1222,0,2106,0,-4,21201,-3,1,-3,1106,0,1192,109,-6,2106,0,0,109,2,21202,-1,1,1,21101,0,1256,2,21101,0,1251,0,1105,1,1174,109,-2,2106,0,0,109,5,22201,-4,-3,-1,22201,-2,-1,-1,204,-1,109,-5,2106,0,0,109,3,1201,-2,0,1280,1006,0,1303,104,45,104,32,1201,-1,66,1292,20102,1,0,1,21101,0,1301,0,1106,0,1234,104,10,109,-3,2106,0,0,0,0,109,2,1202,-1,1,1309,1102,1,0,1308,21102,4601,1,1,21102,1,13,2,21102,4,1,3,21101,1353,0,4,21102,1343,1,0,1105,1,1130,20101,0,1308,-1,109,-2,2105,1,0,65,109,3,2102,1,-2,1360,20008,0,1309,-1,1206,-1,1419,1005,1308,1398,1101,0,1,1308,21008,1309,-1,-1,1206,-1,1387,21102,106,1,1,1106,0,1391,21101,92,0,1,21102,1398,1,0,1106,0,1234,104,45,104,32,1201,-2,1,1408,20102,1,0,1,21101,1417,0,0,1105,1,1234,104,10,109,-3,2105,1,0,109,3,1201,-2,0,1128,21101,0,34,1,21101,1441,0,0,1105,1,1234,1001,1128,0,1446,21002,0,1,1,21102,1456,1,0,1105,1,1234,21101,41,0,1,21102,1467,1,0,1106,0,1234,1001,1128,1,1472,21001,0,0,1,21102,1482,1,0,1105,1,1234,21101,0,46,1,21102,1493,1,0,1105,1,1234,21001,1128,3,1,21101,4,0,2,21101,0,1,3,21102,1273,1,4,21102,1516,1,0,1106,0,1130,21001,1128,0,1,21101,1527,0,0,1106,0,1310,1001,1128,2,1532,21001,0,0,-1,1206,-1,1545,21101,0,1545,0,2105,1,-1,109,-3,2105,1,0,109,0,99,109,2,1101,0,0,1550,21101,0,4601,1,21101,0,13,2,21101,4,0,3,21102,1664,1,4,21102,1,1582,0,1105,1,1130,2,2486,1352,1551,1101,0,0,1552,20102,1,1550,1,21101,0,33,2,21101,0,1702,3,21102,1,1609,0,1105,1,2722,21007,1552,0,-1,1205,-1,1630,20107,0,1552,-1,1205,-1,1637,21102,1,1630,0,1105,1,1752,21101,0,548,1,1105,1,1641,21102,687,1,1,21101,0,1648,0,1106,0,1234,21102,1,4457,1,21101,1659,0,0,1106,0,1424,109,-2,2106,0,0,109,4,21202,-2,-1,-2,1202,-3,1,1675,21008,0,-1,-1,1206,-1,1697,1201,-3,2,1687,20101,-27,0,-3,22201,-3,-2,-3,2001,1550,-3,1550,109,-4,2105,1,0,109,5,21008,1552,0,-1,1206,-1,1747,1201,-3,1901,1716,21002,0,1,-2,1205,-4,1736,20207,-2,1551,-1,1205,-1,1747,1102,1,-1,1552,1106,0,1747,22007,1551,-2,-1,1205,-1,1747,1101,0,1,1552,109,-5,2105,1,0,109,1,21102,826,1,1,21102,1765,1,0,1105,1,1234,21002,1550,1,1,21102,1776,1,0,1106,0,2863,21102,1,1090,1,21101,0,1787,0,1105,1,1234,99,1105,1,1787,109,-1,2105,1,0,109,1,21101,512,0,1,21101,0,1809,0,1105,1,1234,99,1105,1,1809,109,-1,2106,0,0,109,1,1102,1,1,1129,109,-1,2105,1,0,109,1,21101,377,0,1,21102,1842,1,0,1105,1,1234,1106,0,1831,109,-1,2105,1,0,109,1,21102,1,407,1,21101,0,1863,0,1106,0,1234,99,1106,0,1863,109,-1,2105,1,0,109,1,21102,1,452,1,21102,1885,1,0,1106,0,1234,99,1106,0,1885,109,-1,2105,1,0,1941,1947,1953,1958,1965,1972,1978,3591,3942,3706,3841,3916,3616,3425,3875,3890,3984,3496,3689,3675,3818,3303,3890,3207,3262,3318,3808,3365,3783,3920,3642,3343,3412,3515,3392,3675,3388,3379,3485,3840,2281,2468,2418,2450,2487,2125,2505,5,95,108,104,104,23,5,96,91,108,108,1,4,101,105,112,3,6,104,104,106,107,94,-1,6,109,104,109,107,94,-1,5,111,91,100,93,23,5,114,95,108,108,1,109,3,21101,1993,0,0,1106,0,2634,1006,1129,2010,21102,1,316,1,21101,2007,0,0,1105,1,1234,1106,0,2076,21102,0,1,-1,1201,-1,1894,2020,20101,0,0,1,21101,0,0,2,21102,0,1,3,21101,2037,0,0,1106,0,2525,1206,1,2054,1201,-1,1934,2050,21101,0,2051,0,105,1,0,1105,1,2076,21201,-1,1,-1,21207,-1,7,-2,1205,-2,2014,21101,177,0,1,21102,1,2076,0,1106,0,1234,109,-3,2105,1,0,109,3,2001,1128,-2,2089,20102,1,0,-1,1205,-1,2108,21101,201,0,1,21101,0,2105,0,1106,0,1234,1105,1,2119,22101,0,-1,1,21101,2119,0,0,1105,1,1424,109,-3,2105,1,0,0,109,1,1102,0,1,2124,21102,4601,1,1,21101,0,13,2,21101,0,4,3,21102,1,2173,4,21101,2154,0,0,1105,1,1130,1005,2124,2168,21102,226,1,1,21101,0,2168,0,1106,0,1234,109,-1,2105,1,0,109,3,1005,2124,2275,1201,-2,0,2183,20008,0,1128,-1,1206,-1,2275,1201,-2,1,2194,21002,0,1,-1,22102,1,-1,1,21101,0,5,2,21102,1,1,3,21101,2216,0,0,1106,0,2525,1206,1,2275,21102,1,258,1,21102,2230,1,0,1105,1,1234,22102,1,-1,1,21101,2241,0,0,1106,0,1234,104,46,104,10,1102,1,1,2124,1201,-2,0,2256,1102,1,-1,0,1201,-2,3,2263,20101,0,0,-1,1206,-1,2275,21101,2275,0,0,2106,0,-1,109,-3,2106,0,0,0,109,1,1102,0,1,2280,21102,1,4601,1,21102,13,1,2,21102,1,4,3,21102,2329,1,4,21102,1,2310,0,1106,0,1130,1005,2280,2324,21101,273,0,1,21101,0,2324,0,1106,0,1234,109,-1,2105,1,0,109,3,1005,2280,2413,1201,-2,0,2339,21008,0,-1,-1,1206,-1,2413,1201,-2,1,2350,21002,0,1,-1,22101,0,-1,1,21101,0,5,2,21102,1,1,3,21101,0,2372,0,1105,1,2525,1206,1,2413,21102,301,1,1,21102,1,2386,0,1106,0,1234,21202,-1,1,1,21102,1,2397,0,1106,0,1234,104,46,104,10,1101,1,0,2280,1201,-2,0,2412,102,1,1128,0,109,-3,2106,0,0,109,1,21102,1,-1,1,21101,0,2431,0,1105,1,1310,1205,1,2445,21102,1,133,1,21101,2445,0,0,1105,1,1234,109,-1,2105,1,0,109,1,21101,0,3,1,21101,0,2463,0,1105,1,2081,109,-1,2105,1,0,109,1,21102,4,1,1,21102,2481,1,0,1105,1,2081,109,-1,2105,1,0,60,109,1,21102,1,5,1,21101,2500,0,0,1106,0,2081,109,-1,2105,1,0,109,1,21101,6,0,1,21101,0,2518,0,1106,0,2081,109,-1,2105,1,0,0,0,109,5,2102,1,-3,2523,1101,1,0,2524,22102,1,-4,1,21102,2585,1,2,21101,2550,0,0,1105,1,1174,1206,-2,2576,1202,-4,1,2558,2001,0,-3,2566,101,3094,2566,2566,21008,0,-1,-1,1205,-1,2576,1101,0,0,2524,21001,2524,0,-4,109,-5,2106,0,0,109,5,22201,-4,-3,-4,22201,-4,-2,-4,21208,-4,10,-1,1206,-1,2606,21102,-1,1,-4,201,-3,2523,2616,1001,2616,3094,2616,20101,0,0,-1,22208,-4,-1,-1,1205,-1,2629,1102,1,0,2524,109,-5,2105,1,0,109,4,21101,3094,0,1,21102,
    30,1,2,21102,1,1,3,21102,1,2706,4,21101,0,2659,0,1105,1,1130,21102,0,1,-3,203,-2,21208,-2,10,-1,1205,-1,2701,21207,-2,0,-1,1205,-1,2663,21207,-3,29,-1,1206,-1,2663,2101,3094,-3,2693,1201,-2,0,0,21201,-3,1,-3,1105,1,2663,109,-4,2106,0,0,109,2,1202,-1,1,2715,1102,1,-1,0,109,-2,2106,0,0,0,109,5,1202,-2,1,2721,21207,-4,0,-1,1206,-1,2739,21101,0,0,-4,21201,-4,0,1,21201,-3,0,2,21101,1,0,3,21101,0,2758,0,1105,1,2763,109,-5,2106,0,0,109,6,21207,-4,1,-1,1206,-1,2786,22207,-5,-3,-1,1206,-1,2786,22102,1,-5,-5,1106,0,2858,22101,0,-5,1,21201,-4,-1,2,21202,-3,2,3,21102,1,2805,0,1105,1,2763,22101,0,1,-5,21102,1,1,-2,22207,-5,-3,-1,1206,-1,2824,21101,0,0,-2,22202,-3,-2,-3,22107,0,-4,-1,1206,-1,2850,22101,0,-2,1,21201,-4,-1,2,21102,2850,1,0,106,0,2721,21202,-3,-1,-3,22201,-5,-3,-5,109,-6,2106,0,0,109,3,21208,-2,0,-1,1205,-1,2902,21207,-2,0,-1,1205,-1,2882,1106,0,2888,104,45,21202,-2,-1,-2,22102,1,-2,1,21101,0,2899,0,1105,1,2909,1106,0,2904,104,48,109,-3,2106,0,0,109,4,22101,0,-3,1,21101,0,10,2,21101,2926,0,0,1105,1,3010,21202,1,1,-2,22101,0,2,-1,1206,-2,2948,21202,-2,1,1,21102,1,2948,0,1105,1,2909,22101,48,-1,-1,204,-1,109,-4,2105,1,0,1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,4294967296,8589934592,17179869184,34359738368,68719476736,137438953472,274877906944,549755813888,1099511627776,2199023255552,4398046511104,8796093022208,17592186044416,35184372088832,70368744177664,140737488355328,281474976710656,562949953421312,1125899906842624,109,8,21101,0,0,-4,21101,0,0,-3,21102,51,1,-2,21201,-2,-1,-2,1201,-2,2959,3033,21002,0,1,-1,21202,-3,2,-3,22207,-7,-1,-5,1205,-5,3059,21201,-3,1,-3,22102,-1,-1,-5,22201,-7,-5,-7,22207,-3,-6,-5,1205,-5,3078,22102,-1,-6,-5,22201,-3,-5,-3,22201,-1,-4,-4,1205,-2,3024,21201,-4,0,-7,22101,0,-3,-6,109,-8,2105,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3131,3143,0,0,3252,3968,3323,11,61,105,95,94,17,50,97,83,78,79,83,108,-19,2,7,-79,-9,-2,2,-83,-11,-7,-86,-3,-16,-7,-11,-6,-21,-21,-94,-30,-96,-25,-19,-23,-31,-101,-29,-25,-104,-21,-34,-38,-108,-39,-34,-32,-33,-31,-114,-43,-47,-35,-49,-105,-120,-69,-43,-123,-49,-56,-57,-47,-128,-40,-51,-46,-50,-133,-51,-63,-63,-57,-138,-69,-58,-62,-65,-143,-79,-69,-63,-68,-148,-79,-68,-82,-83,-63,-81,-77,-85,-145,-158,-75,-88,-92,-162,-91,-85,-89,-97,-167,-96,-104,-87,-171,-106,-104,-105,-97,-176,-94,-109,-114,-104,-112,-114,-169,3259,3271,0,0,3415,0,3124,11,58,98,90,91,95,85,84,96,86,90,82,51,38,59,64,-22,60,45,44,-26,38,-28,58,42,42,52,36,32,44,29,45,30,-39,47,32,42,29,-44,35,30,18,30,34,-50,19,27,29,-54,-4,24,25,15,19,11,7,20,16,9,3,-66,19,-50,-55,3330,3338,0,0,3124,3758,3504,7,65,89,99,98,108,85,108,76,8,27,27,36,-48,16,32,18,13,-53,18,10,27,-57,8,10,9,17,-62,16,16,19,7,10,5,21,-1,-3,-72,-3,5,7,-76,6,1,-2,-11,3,-10,-10,-6,-14,-59,-87,1,-10,-5,-84,-10,-24,-94,-21,-11,-14,-14,-99,-22,-22,-18,-103,-23,-20,-33,-23,-39,-109,-27,-26,-30,-44,-114,-28,-44,-52,-34,-105,3422,3431,0,0,0,3577,3252,8,75,96,89,96,20,53,83,106,72,11,44,38,37,35,37,38,36,-48,17,29,33,20,-53,-4,14,12,-44,-12,20,23,8,6,-63,-14,4,7,11,0,0,-1,11,-72,4,-5,-7,-3,-10,-5,-1,-11,-81,-17,-5,-16,-85,-4,-18,-17,-4,-14,-26,-10,-93,-12,-26,-23,-19,-30,-30,-31,-19,-102,-26,-35,-37,-33,-40,-35,-31,-41,-97,3511,3520,0,4043,3323,0,0,8,64,102,98,100,88,88,85,92,56,27,54,51,42,51,49,39,-31,51,36,35,42,47,-37,46,40,-40,31,23,43,25,-45,30,22,22,35,-50,22,32,-53,25,23,-56,27,14,10,-60,-22,11,2,14,19,-66,-28,14,4,-2,-71,11,-4,10,9,-3,1,-7,-65,3584,3598,0,3415,3634,0,3693,13,54,100,86,103,15,63,98,77,93,94,78,90,90,35,49,68,64,-6,59,61,59,73,-11,53,69,55,-15,49,59,58,-19,64,58,57,-23,59,52,39,49,48,-29,40,48,50,-33,55,44,49,-23,3641,3664,0,3918,0,4250,3577,22,50,88,92,7,41,77,83,70,81,77,65,83,67,-3,34,74,79,71,76,56,63,67,28,55,82,79,70,72,78,85,9,-4,68,78,0,75,-9,73,73,61,63,62,-15,71,62,64,56,53,57,49,-9,3700,3723,0,0,3577,4115,0,22,65,74,90,87,6,41,86,76,88,70,0,44,63,70,74,79,63,71,57,69,57,58,34,39,81,-4,60,74,73,61,56,72,72,-12,71,65,-15,50,52,-18,68,59,61,53,50,54,46,-26,51,51,53,47,34,44,43,55,-21,3765,3776,0,3323,4195,3854,0,10,68,86,106,92,89,82,100,88,93,91,77,6,38,18,36,36,33,-25,-52,-2,30,27,9,21,10,10,8,-47,-62,-15,12,4,-1,16,1,-69,13,14,8,7,2,14,-76,0,-9,-14,3,4,0,-14,-7,-16,-8,-3,-5,-89,-20,-9,-13,-16,-94,-25,-23,-27,-14,-10,-100,-18,-18,-38,-22,-22,-106,-23,-29,-109,-28,-42,-45,-48,-38,-42,-50,-35,-53,-35,-51,-107,3861,3869,0,3758,0,0,0,7,76,108,102,104,86,91,88,48,36,55,51,-19,46,58,66,46,59,-25,48,58,55,55,-30,36,47,45,50,30,37,41,-38,38,39,41,27,-43,22,34,42,22,35,-35,-50,-51,-2,16,13,30,26,26,15,27,9,15,27,-49,3925,3933,0,0,0,3634,4346,7,76,108,88,88,97,89,102,34,48,66,69,73,62,62,61,73,3,72,61,77,55,53,-2,-17,34,53,49,68,-15,59,45,-25,39,49,48,-29,39,46,48,51,55,-21,3975,3987,0,3124,0,0,0,11,72,87,92,87,95,83,84,14,57,77,77,55,34,55,60,-26,56,41,40,-30,38,54,40,34,34,42,30,31,-39,32,28,40,26,-44,34,24,-47,32,33,29,33,27,31,35,25,13,-57,22,20,16,28,15,6,18,-65,2,2,15,4,1,7,-72,14,5,7,-1,-63,4050,4059,0,0,0,3504,0,8,72,88,105,104,85,90,87,100,55,29,48,44,63,-20,54,40,-30,34,-32,43,39,49,48,39,31,-39,44,46,31,40,40,44,-46,18,30,19,-50,32,32,12,28,29,17,21,13,-59,24,18,-62,13,15,14,9,-67,-3,7,6,-71,-7,3,-1,0,-7,-63,4122,4134,0,3693,0,0,4388,11,68,86,102,87,99,102,80,98,92,94,100,60,24,43,39,51,37,-33,31,47,33,-37,27,-39,30,28,45,-43,40,24,30,22,35,18,29,29,17,30,-27,-55,28,15,11,30,-53,21,7,-63,1,11,10,-67,-2,10,6,13,-3,-5,-74,-7,3,10,0,-67,-80,3,-10,-4,1,-14,-14,-73,4202,4209,0,0,0,0,3758,6,59,107,91,88,90,90,40,38,70,68,58,-12,66,56,-15,68,55,51,-19,47,44,44,50,54,44,58,56,-28,54,39,38,45,-33,50,44,-36,35,27,47,29,-41,38,36,43,24,36,-33,4257,4266,0,3634,0,0,0,8,59,102,104,103,93,87,97,99,79,5,24,20,-50,26,17,31,11,21,-56,30,7,17,16,22,-62,2,14,3,-66,17,4,0,-70,6,-3,11,-9,1,-76,-7,-2,0,-1,1,-82,-18,-2,-16,-86,-4,-12,-16,-19,-19,-8,-17,-5,-95,-28,-24,-28,-29,-31,-19,-33,-25,-20,-105,-39,-28,-32,-30,-28,-28,-98,-113,-67,-33,-116,-52,-36,-50,-120,-37,-50,-54,-35,-94,4353,4361,0,0,3918,0,0,7,68,97,107,89,93,89,97,26,43,91,73,85,91,85,72,72,76,68,3,78,-6,63,74,60,59,79,57,0,54,67,57,52,50,-5,4395,4416,0,0,4115,4457,0,20,51,84,80,93,8,62,88,70,84,83,75,79,71,-1,33,66,74,79,63,75,40,32,70,77,-11,57,63,69,54,-16,51,61,-19,69,58,63,-23,63,57,39,53,-28,51,52,38,51,36,44,49,47,-37,41,39,-40,43,30,26,-44,26,33,-16,4464,4484,0,4388,0,4556,0,19,64,81,78,95,91,81,91,95,5,39,75,71,68,75,79,77,70,74,79,71,2,38,-41,42,29,25,-45,32,22,40,35,-50,31,27,26,23,-43,-56,8,-58,21,22,8,21,20,21,17,3,-54,15,0,8,12,1,11,-1,11,-7,-77,-8,-3,-1,-2,0,-83,3,-12,-10,-11,-88,-3,-21,-9,-19,-23,-5,-95,-7,-18,-13,-17,-100,-28,-34,-34,-26,-21,-33,-23,-19,-95,4563,4588,1553,4457,0,0,0,24,56,89,75,88,87,88,84,70,13,50,67,75,79,68,78,66,78,60,-10,27,64,66,65,67,12,53,97,83,93,105,105,87,91,83,25,24,23,3415,4653,27,1796,4250,4664,1052,0,3252,4675,268435485,0,4115,4679,30,1829,3854,4693,8388639,0,3634,4698,32,1872,3504,4706,33,1818,3918,4726,34,1850,3968,4738,16419,0,3758,4754,4132,0,4388,4766,2085,0,4195,4772,536870950,0,4043,4785,2147483687,0,10,91,104,87,84,98,86,16,95,93,81,10,91,86,103,103,87,99,16,84,85,84,3,106,113,98,13,92,96,87,89,93,87,97,81,11,86,88,87,87,4,111,92,104,93,7,105,96,102,106,100,98,102,19,84,85,76,88,93,8,76,82,74,71,87,84,80,77,64,69,75,65,79,11,98,99,95,102,86,94,15,90,78,98,76,15,104,85,80,98,85,81,93,10,86,73,74,78,78,82,72,11,91,89,102,102,90,102,84,14,85,77,95,5,110,98,94,100,99,12,107,91,91,99,92,84,82,13,92,80,75,92,12,103,99,83,84,85,15,86,82,77,95,79,91]
    ]


intcode = Intcode(codebank[7])

import os
import sys
os.system("mode con cols=240 lines=240")

intcode.debug = False
curses_on = False
if curses_on:

    WINDOW_SIZE_X = 120
    WINDOW_SIZE_Y = 120
    import curses

    stdscr = curses.initscr()

    #resize = curses.is_term_resized(WINDOW_SIZE_X,WINDOW_SIZE_Y)
    #if resize is True:
    #    stdscr.clear()
    #curses.resize_term(WINDOW_SIZE_X,WINDOW_SIZE_Y)
    #stdscr.refresh()

    # init the screen
    curses.noecho()
    curses.cbreak()
    curses.curs_set(0)

    #check for and begin color support
    if curses.has_colors(): curses.start_color()

    #initialize the color combinations we're going to use
    #                      Fore             back
    curses.init_pair(1, curses.COLOR_RED, curses.COLOR_BLACK)
    curses.init_pair(2, curses.COLOR_GREEN, curses.COLOR_BLACK)
    curses.init_pair(3, curses.COLOR_BLUE, curses.COLOR_BLACK)
    curses.init_pair(4, curses.COLOR_MAGENTA, curses.COLOR_BLACK)

    stdscr.addstr("AOC Day 17", curses.A_REVERSE)
    stdscr.chgat(-1,curses.A_REVERSE)

    stdscr.addstr(curses.LINES-1,0,"(1)North (2)South (3)West (4)East  (Q) Quit")
    stdscr.addstr(curses.LINES-1,curses.COLS-14,"STATUS:  0")
    stdscr.addstr(curses.LINES-1,curses.COLS-32,"Last Key: 0")
    #change colors
    stdscr.chgat(curses.LINES-1,1,1,curses.A_BOLD | curses.color_pair(2))
    stdscr.chgat(curses.LINES-1,10,1,curses.A_BOLD | curses.color_pair(2))
    stdscr.chgat(curses.LINES-1,19,1,curses.A_BOLD | curses.color_pair(2))
    stdscr.chgat(curses.LINES-1,27,1,curses.A_BOLD | curses.color_pair(2))
    stdscr.chgat(curses.LINES-1,36,1,curses.A_BOLD | curses.color_pair(1))

    game_window = curses.newwin(curses.LINES-2,curses.COLS,1,0)

    text_window = game_window.subwin(curses.LINES-6,curses.COLS-4,3,2)

    buffer = []
    line = " "*(curses.COLS-5)
    line+="\n"
    #text_window.addstr(line)
    #board = Board(curses.COLS-5, curses.LINES-7)
    
    #board.draw_to_screen(text_window, curses.color_pair(1))

    game_window.box()
    stdscr.noutrefresh()
    game_window.noutrefresh()

    game_window.timeout(0)

    curses.doupdate()

    
    last_key = ""
    status = " "
    
    while True:
        c = int(game_window.getch())
        if c == ord('q') or c == ord('Q'):
            break
        elif c != -1:
            stdscr.addstr(curses.LINES-1,curses.COLS-22,chr(c), curses.color_pair(4))
            if chr(c) == 'w':
                c = ord('1')
            elif chr(c) == 's':
                c = ord('2')
            elif chr(c) == 'a':
                c = ord('3')
            elif chr(c) == 'd':
                c = ord('4')
            last_key = int(chr(c))

            if last_key == 'a':
                auto = True
                status = "A"
            else:
                intcode.input(last_key)

            
        
        result = intcode.cycle()
        if result == intcode.OUTPUT_AVAILABLE:
            val = intcode.output()
            board.move(direction=last_key, result=val)

        elif result == intcode.INPUT_NEEDED:
            status = "W" # waiting

        elif result == intcode.COMPLETE:
            status = "C" # complete
        elif result == intcode.NO_ERROR:
            status = "R"
        else:
            val = result
            text_window.addstr("Output: {}".format(val), curses.color_pair(3))
            status="?"
        
        stdscr.addstr(curses.LINES-1,curses.COLS-5,status, curses.color_pair(4))
        
        board.draw_to_screen(text_window, curses.color_pair(1))
        
        #curses.curs_set(0)   
        stdscr.noutrefresh()
        game_window.noutrefresh()
        text_window.noutrefresh()
        curses.doupdate()


    curses.nocbreak()
    curses.echo()
    curses.curs_set(1)

    curses.endwin()
else:
    # row = 0
    # col = 0
    # buffer = [["*" for i in range(46)] for j in range(500)]
    # z = ord(',')
    # a = ord('A')
    # b = ord('B')
    # c = ord('C')
    # r = ord('R')
    # l = ord('L')
    # one = ord('1')

    # #inputs = [a,z,b,z,c,10,l,z,ord('9'),10,l,z,ord('9'),10,r,z,ord('1'),ord('0'),10,ord('y'),10 ]
    # main = "A,B,A,C,B,A,C,B,A,C" + chr(10)
    # prog_a= "L,6,L,4,R,12" +chr(10)
    # prog_b= "L,6,R,12,R,12,L,8" + chr(10)
    # prog_c= "L,6,L,10,L,10,L,6" +chr(10)

    # inputs = []
    # for i in main:
    #     inputs.append(ord(i))
    # for i in prog_a:
    #     inputs.append(ord(i))
    # for i in prog_b:
    #     inputs.append(ord(i))
    # for i in prog_c:
    #     inputs.append(ord(i))
    
    # inputs.append(ord('n'))
    # inputs.append(10)

    # inputs = [ "A,B,C" +chr(10),
    #            "L,9"+chr(10),
    #            "R,2"+chr(10),
    #            "L,4"+chr(10),
    #            "y"+chr(10)]

    # inputs2 = []
    # for i in inputs:
    #     if len(i) > 20:
    #         print("Argument Error!")
    #         sys.exit(1)
    #     val = 0
    #     for j in i:
    #         val = val*100 + ord(j)
    #     print(val)                
    #     inputs2.append(val)

    input_index = 0
    while True:
       
        
        result = intcode.run() # run until blocked
        if result == intcode.OUTPUT_AVAILABLE:
            val = intcode.output()
            if val < 255:
                print(chr(val), end="")
            else:
                print("{}".format(val))
            #buffer[row][col] = chr(val)
            # if val == 10:
            #     row+=1
            #     col=0
            # else:
            #     col+=1

        elif result == intcode.INPUT_NEEDED:
            #text_window.addstr(2,2,"W...", curses.color_pair(3))
            print("Input needed!")
            val = input("$")
            if val == "n":
                val = "north"
            if val == "s":
                val = "south"
            if val == "e":
                val = "east"
            if val == "w":
                val = "west" 
            for i in val:
                intcode.input(ord(i))
            intcode.input(10)
            #print("Inputing: {}".format(inputs[input_index]))
            #intcode.input(inputs[input_index])
            #input_index+=1
        elif result == intcode.COMPLETE:
            print("Complete")
            break
        else:
            val = result
            print("Unknown: {}".format(val), curses.color_pair(3))
sum = 0 
# for r in range(len(buffer)):
#     if buffer[r][0] == '*':
#         print("done")
#         break
#     else:
#         print("r {}: ".format(r), end="")
#     for c in range(len(buffer[r])):
#         print(buffer[r][c], end="")

# for r in range(len(buffer)):
#     if buffer[r][0] == '*':
#         print("done")
#         break
#     for c in range(len(buffer[r])):
#         if not(r  == 0 or r == row-1 or c == 0 or col == 44):
#             if buffer[r][c] == '#' and buffer[r-1][c] == '#' and buffer[r+1][c] == '#' and buffer[r][c-1] == '#' and buffer[r][c+1] == '#':
#                 print("{}x{}={}".format(r,c,r*c))
#                 sum+= r*c
# print("sum: {}".format(sum))



    # #print(len(codebank[4]))    
# running = True
# debug = False
# while running:
#     val = int(input("$: "))
#     if val in range(1,9):
#         intcode(codebank[val], debug)
#     elif val == 0:
#         debug = not debug
#         print("Debug: {}".format(debug))
#     else:
#         running = False
        
            